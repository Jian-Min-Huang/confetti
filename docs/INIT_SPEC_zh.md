# Confetti.app — 設計規格書

## 1. 簡介

Confetti.app 是一個 macOS 命令列原生應用，以透明覆蓋層的形式在全螢幕顯示粒子動畫。通過 Hooks 觸發，為 AI Agent 在任務完成時提供視覺反饋效果。

## 2. 需求

### 2.1 功能需求

| ID    | 需求                                                                 |
| ----- | -------------------------------------------------------------------- |
| FR-1  | 透過 `open Confetti.app` 啟動，無需額外設定                          |
| FR-2  | 不顯示 Dock 圖示，不顯示選單列                                       |
| FR-3  | 在所有視窗之上顯示全螢幕透明覆蓋層                                   |
| FR-4  | 覆蓋層必須能穿透點擊，所有滑鼠事件傳遞至底層視窗                     |
| FR-5  | 支援多螢幕，每個螢幕各自播放動畫                                     |
| FR-6  | 使用多種 Emoji 作為動畫粒子，預設為 `🎉🎊✨`                         |
| FR-7  | 支援多種特效樣式：`confetti`、`falling-leaves`、`fireworks`          |
| FR-8  | 支援多種 Easing 函數：`linear`、`ease-in`、`ease-out`、`ease-in-out` |
| FR-9  | 接受 `--style <name>` 參數選擇特效樣式                               |
| FR-10 | 接受 `--emojis <list>` 參數自訂粒子 Emoji                            |
| FR-11 | 接受 `--density <level>` 參數控制粒子密度（low/medium/high）         |
| FR-12 | 接受 `--speed <multiplier>` 參數調整動畫速度                         |
| FR-13 | 接受 `--easing <type>` 參數控制動畫速度曲線                          |
| FR-14 | 接受 `--duration <seconds>` 參數控制特效播放時間                     |
| FR-15 | `--style` 預設值為 `confetti`                                        |
| FR-16 | `--emojis` 預設值為 `🎉🎊✨`                                         |
| FR-17 | `--density` 預設值為 `medium`                                        |
| FR-18 | `--speed` 預設值為 `1.0`                                             |
| FR-19 | `--easing` 預設值為 `ease-out`                                       |
| FR-20 | `--duration` 預設值為 `5` 秒                                         |
| FR-21 | 動畫結束後自動終止                                                   |
| FR-22 | 支援按 `Esc` 鍵提前結束動畫                                          |

#### 2.1.1 特效樣式定義

| 樣式             | 運動方式                                                                                                                                      |
| ---------------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| `confetti`       | 粒子從畫面分別由左下角向右上角射出和右下角向左上角射出，隨機到達 70~90% 螢幕高度後，開始左右搖擺與旋轉，模擬紙片飄落                          |
| `falling-leaves` | 粒子從畫面頂部隨機位置分批落下，每片葉子以正弦波左右擺動並持續旋轉，同時有微量隨機橫向飄移模擬風吹效果，模擬秋天落葉飄落                      |
| `fireworks`      | 粒子從畫面底部發射上升，隨機到達 70~90% 螢幕高度後向四周爆開擴散，模擬煙火效果。每個螢幕有隨機 3~5 個煙火，彼此之間有隨機距離的間隔，避免重疊 |

### 2.2 非功能需求

| ID    | 需求                                  |
| ----- | ------------------------------------- |
| NFR-1 | 零外部依賴                            |
| NFR-2 | GPU 加速渲染，確保動畫流暢            |
| NFR-3 | 自包含二進位——不需要圖片資源檔案      |
| NFR-4 | 完全從命令列建置（不需要 Xcode 專案） |
| NFR-5 | 持續擴充特效的架構設計                |
